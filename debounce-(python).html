<!doctype html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1"><meta http-equiv="X-UA-Compatible" content="ie=edge"><meta name="description" content="How to create and use a debouncer in Python."><title>Debounce (Python)</title><link rel="stylesheet" href="./styles.css"></head><body>
<main id="main"><article id="content">            <h1 id="title">Debounce (Python)</h1>
            <p>How to create and use a <a href="debounce.html">debouncer</a> in <a href="python.html">Python</a>.</p>
<p>In both of these examples, the inner function won't run until at least DEBOUNCE_TIME seconds has passed.</p>
<h2>Standalone</h2>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">threading</span> <span class="kn">import</span> <span class="n">Timer</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="n">DEBOUNCE_TIME</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># 1 second</span>
<span class="n">debounced_action</span> <span class="o">=</span> <span class="kc">None</span>


<span class="k">def</span> <span class="nf">debounce_action</span><span class="p">(</span><span class="n">message</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot; Print the last message to be invoked within a certain amount of time &quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">debounced_action</span>

    <span class="k">def</span> <span class="nf">print_message</span><span class="p">():</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">debounced_action</span><span class="p">:</span>
        <span class="n">debounced_action</span><span class="o">.</span><span class="n">cancel</span><span class="p">()</span>
    <span class="n">debounced_action</span> <span class="o">=</span> <span class="n">Timer</span><span class="p">(</span><span class="n">DEBOUNCE_TIME</span><span class="p">,</span> <span class="n">print_message</span><span class="p">)</span>
    <span class="n">debounced_action</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">debounce_action</span><span class="p">(</span><span class="s2">&quot;Won&#39;t print this one&quot;</span><span class="p">)</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">.5</span><span class="p">)</span>
    <span class="n">debounce_action</span><span class="p">(</span><span class="s2">&quot;Or this one&quot;</span><span class="p">)</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">.99</span><span class="p">)</span>
    <span class="n">debounce_action</span><span class="p">(</span><span class="s2">&quot;This one will though!&quot;</span><span class="p">)</span>
</pre></div>
<p>The benefit of using this standalone is that you can have multiple items debouncing with the same inner function and different parameters by using a dict to store the different <code>debounced_action</code>s instead of using a singular global.</p>
<h2>Decorator</h2>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">threading</span> <span class="kn">import</span> <span class="n">Timer</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="n">DEBOUNCE_TIME</span> <span class="o">=</span> <span class="mi">1</span>


<span class="k">def</span> <span class="nf">debounce</span><span class="p">(</span><span class="n">wait</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Decorator that will postpone a functions</span>
<span class="sd">        execution until after wait seconds</span>
<span class="sd">        have elapsed since the last time it was invoked. &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">decorator</span><span class="p">(</span><span class="n">fn</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">debounced</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">call_it</span><span class="p">():</span>
                <span class="n">fn</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">debounced</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">cancel</span><span class="p">()</span>
            <span class="k">except</span><span class="p">(</span><span class="ne">AttributeError</span><span class="p">):</span>
                <span class="k">pass</span>
            <span class="n">debounced</span><span class="o">.</span><span class="n">t</span> <span class="o">=</span> <span class="n">Timer</span><span class="p">(</span><span class="n">wait</span><span class="p">,</span> <span class="n">call_it</span><span class="p">)</span>
            <span class="n">debounced</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">debounced</span>
    <span class="k">return</span> <span class="n">decorator</span>


<span class="nd">@debounce</span><span class="p">(</span><span class="n">DEBOUNCE_TIME</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">print_message</span><span class="p">(</span><span class="n">message</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">print_message</span><span class="p">(</span><span class="s2">&quot;Won&#39;t print this one&quot;</span><span class="p">)</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">.5</span><span class="p">)</span>
    <span class="n">print_message</span><span class="p">(</span><span class="s2">&quot;Or this one&quot;</span><span class="p">)</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">.99</span><span class="p">)</span>
    <span class="n">print_message</span><span class="p">(</span><span class="s2">&quot;This one will though!&quot;</span><span class="p">)</span>
</pre></div>
<p>The benefit of using a decorator is you can throw it on any function that needs debouncing at it saves you the reuse of the debouncing code in multiple places.</p>
<h2>References:</h2>
<ol>
<li><a href="https://gist.github.com/walkermatt/2871026" target="_blank">https://gist.github.com/walkermatt/2871026</a></li>
</ol>

<p class="last-modified"><em>Last modified: 202107212151</em></p></article></main><footer><nav><p><a href="index.html">Sitemap</a></p><p><a href="fatfile.html">Fatfile (~602kb)</a></p></nav><div class="social"><p>Built using <a href="http://github.com/milofultz/swiki" target="_blank" rel="noopener noreferrer">{{SWIKI}}</a></p><p><a href="http://github.com/milofultz/" target="_blank" rel="noopener noreferrer">GitHub</a></p><p><a href="http://milofultz.com/" target="_blank" rel="noopener noreferrer">milofultz.com</a></p><p><a href="https://merveilles.town/@milofultz" target="_blank" rel="me noopener noreferrer">Mastodon</a></p></div></footer></body></html>